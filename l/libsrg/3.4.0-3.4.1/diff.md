# Comparing `tmp/libsrg-3.4.0-py3-none-any.whl.zip` & `tmp/libsrg-3.4.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 32435 bytes, number of entries: 25
+Zip file size: 34456 bytes, number of entries: 25
 -rw-r--r--  2.0 unx     1754 b- defN 23-Jun-14 19:59 libsrg/ElapsedTime.py
 -rw-r--r--  2.0 unx     2184 b- defN 23-May-22 23:49 libsrg/Info.py
 -rw-r--r--  2.0 unx     3532 b- defN 23-Jan-31 15:26 libsrg/LevelBanner.py
 -rw-r--r--  2.0 unx     1492 b- defN 23-Jan-18 20:30 libsrg/LoggerGUIProxy.py
 -rw-r--r--  2.0 unx     5511 b- defN 23-Jan-31 15:26 libsrg/LoggingAppBase.py
 -rw-r--r--  2.0 unx     5656 b- defN 23-Jun-14 19:59 libsrg/LoggingCounter.py
 -rw-r--r--  2.0 unx      413 b- defN 23-Jan-31 15:26 libsrg/LoggingUtils.py
 -rw-r--r--  2.0 unx     1376 b- defN 23-Jan-08 15:03 libsrg/LoggingWatcher.py
 -rw-r--r--  2.0 unx     2680 b- defN 23-Jan-31 15:30 libsrg/NagiosBase.py
 -rw-r--r--  2.0 unx    14015 b- defN 23-May-01 17:29 libsrg/ReZFS.py
 -rw-r--r--  2.0 unx     4449 b- defN 23-Jun-14 20:09 libsrg/Runner.py
 -rw-r--r--  2.0 unx     4035 b- defN 23-May-22 23:46 libsrg/Runner2.py
 -rw-r--r--  2.0 unx     6968 b- defN 23-Jun-08 00:08 libsrg/Stage0.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jan-31 16:52 libsrg/__init__.py
--rw-r--r--  2.0 unx    17507 b- defN 23-Jun-04 19:37 libsrg/ztool.py
+-rw-r--r--  2.0 unx    25985 b- defN 23-Jun-16 14:53 libsrg/ztool.py
 -rw-r--r--  2.0 unx     2214 b- defN 23-Feb-05 15:02 libsrg/TKGUI/GuiBase.py
 -rw-r--r--  2.0 unx      447 b- defN 22-Mar-14 16:04 libsrg/TKGUI/GuiRequest.py
 -rw-r--r--  2.0 unx     3414 b- defN 23-Feb-05 15:22 libsrg/TKGUI/GuiRequestQueue.py
 -rw-r--r--  2.0 unx    10692 b- defN 23-May-15 18:18 libsrg/TKGUI/LoggerGUI.py
 -rw-r--r--  2.0 unx        1 b- defN 23-Jan-31 17:16 libsrg/TKGUI/__init__.py
--rw-rw-rw-  2.0 unx     1069 b- defN 23-Jun-14 20:18 libsrg-3.4.0.dist-info/LICENSE.txt
--rw-r--r--  2.0 unx     3357 b- defN 23-Jun-14 20:18 libsrg-3.4.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-14 20:18 libsrg-3.4.0.dist-info/WHEEL
--rw-rw-rw-  2.0 unx        7 b- defN 23-Jun-14 20:18 libsrg-3.4.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1939 b- defN 23-Jun-14 20:18 libsrg-3.4.0.dist-info/RECORD
-25 files, 94804 bytes uncompressed, 29357 bytes compressed:  69.0%
+-rw-rw-rw-  2.0 unx     1069 b- defN 23-Jun-16 15:05 libsrg-3.4.1.dist-info/LICENSE.txt
+-rw-r--r--  2.0 unx     3357 b- defN 23-Jun-16 15:05 libsrg-3.4.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-16 15:05 libsrg-3.4.1.dist-info/WHEEL
+-rw-rw-rw-  2.0 unx        7 b- defN 23-Jun-16 15:05 libsrg-3.4.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1939 b- defN 23-Jun-16 15:05 libsrg-3.4.1.dist-info/RECORD
+25 files, 103282 bytes uncompressed, 31378 bytes compressed:  69.6%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: libsrg/TKGUI/LoggerGUI.py
 Comment: 
 
 Filename: libsrg/TKGUI/__init__.py
 Comment: 
 
-Filename: libsrg-3.4.0.dist-info/LICENSE.txt
+Filename: libsrg-3.4.1.dist-info/LICENSE.txt
 Comment: 
 
-Filename: libsrg-3.4.0.dist-info/METADATA
+Filename: libsrg-3.4.1.dist-info/METADATA
 Comment: 
 
-Filename: libsrg-3.4.0.dist-info/WHEEL
+Filename: libsrg-3.4.1.dist-info/WHEEL
 Comment: 
 
-Filename: libsrg-3.4.0.dist-info/top_level.txt
+Filename: libsrg-3.4.1.dist-info/top_level.txt
 Comment: 
 
-Filename: libsrg-3.4.0.dist-info/RECORD
+Filename: libsrg-3.4.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## libsrg/ztool.py

```diff
@@ -23,14 +23,195 @@
         return self
 
     def __exit__(self, exc_type, exc_value, exc_tb):
         r = Runner(["zfs", "release", "ztool-copy", self.snap], userat=self.userat)
         r.raise_if_failed()
 
 
+"""
+# python -m libsrg.ztool copy --help
+This is a multipurpose zfs support utility
+
+It can always be run as
+* python -m libsrg.ztool mode rest...
+
+It is normally installed with a short stub in /usr/local/bin/ztool.py, which can be run as
+* ztool.py mode rest...
+
+First argument is a mandatory positional arguments for mode, and must be one of:
+  {prep,copy,xfer,info,permissions}
+
+-----------------------------------------------------------------------------------------
+COPY:
+* copies from source to destination volume
+* src and/or dest can be on another node if the userat arguments are used (and ssh keys are setup)
+* can create new destination, or update an old copy with newer snapshots
+  * first,last args allow manual control of snapshots
+  * default is to copy range from first common snapshot to latest at src
+
+usage: usage: %prog copy [-h] [--libsrg] [--logfile LOGFILE] [--logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}] [--src_userat SRC_USERAT] [--dst_userat DST_USERAT] [--src SRC]
+                              [--dst DST] [--first FIRST] [--last LAST]
+                              {prep,copy,xfer,info,permissions}
+
+
+
+options:
+  -h, --help            show this help message and exit
+  --libsrg              Print version of libsrg and exit
+  --logfile LOGFILE     file to log to (default = stdout)
+  --logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}, --level {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}
+  --src_userat SRC_USERAT
+                        user@host for src
+  --dst_userat DST_USERAT
+                        user@host for dst
+  --src SRC             source dataset
+  --dst DST             destination dataset
+  --first FIRST         index of first snapshot
+  --last LAST           index of last snapshot
+
+-------------------------------------------------------------------------------------------------
+INFO: 
+Sends formatted pool information to stdout
+This is intended to print and keep a zfs backup disk
+
+usage: usage: %prog info pools... [-h] [--libsrg] [--logfile LOGFILE] [--logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}] [--src_userat SRC_USERAT] [--dst_userat DST_USERAT] [--first FIRST]
+                              [--last LAST]
+                              {prep,copy,xfer,info,permissions} [pools ...]
+
+positional arguments:
+  {prep,copy,xfer,info,permissions}
+  pools                 ZFS pools to inventory
+
+options:
+  -h, --help            show this help message and exit
+  --libsrg              Print version of libsrg and exit
+  --logfile LOGFILE     file to log to (default = stdout)
+  --logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}, --level {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}
+  --src_userat SRC_USERAT
+                        user@host for src
+  --dst_userat DST_USERAT
+                        user@host for dst
+  --first FIRST         index of first snapshot
+  --last LAST           index of last snapshot
+
+========== sample python -m libsrg.ztool info ZRaid
+  pool: ZRaid
+ state: ONLINE
+  scan: scrub repaired 0B in 00:30:31 with 0 errors on Mon Jun 12 02:00:32 2023
+config:
+
+	NAME                                       STATE     READ WRITE CKSUM
+	ZRaid                                      ONLINE       0     0     0
+	  ata-WDC_WDS100T2G0A-00JH30_191077453312  ONLINE       0     0     0
+
+errors: No known data errors
+
+NAME                                  AVAIL   USED  USEDSNAP  USEDDS  USEDREFRESERV  USEDCHILD  QUOTA
+ZRaid                                  488G   412G        0B     29K             0B       412G   none
+ZRaid/CLONES                           488G    24K        0B     24K             0B         0B   none
+ZRaid/COPIES                           488G    24K        0B     24K             0B         0B   none
+ZRaid/COPYTEST                         488G   428K        0B     25K             0B       403K   none
+ZRaid/COPYTEST/LIBVIRT_QEMU            488G   379K      350K     29K             0B         0B   none
+ZRaid/COPYTEST/ZAP                     488G    24K        0B     24K             0B         0B   none
+ZRaid/LEGACY                           488G    24K        0B     24K             0B         0B   none
+ZRaid/MIGRATED                         488G    24K        0B     24K             0B         0B   none
+ZRaid/PRIMARY                          488G   409G        0B     26K             0B       409G   none
+ZRaid/PRIMARY/NFSNONE                  488G    24K        0B     24K             0B         0B   none
+ZRaid/PRIMARY/NFSPUB                   488G    24K        0B     24K             0B         0B   none
+ZRaid/PRIMARY/NFSUSER                  488G   409G        0B     24K             0B       409G   none
+ZRaid/PRIMARY/NFSUSER/KUSERS           291G   409G      246G    163G             0B         0B   700G
+ZRaid/PRIMARY/NFSUSER/LIBVIRT_IMAGES   400G  1.65M      270K   1.39M             0B         0B   400G
+ZRaid/PRIMARY/NFSUSER/LIBVIRT_QEMU    10.0G   437K      408K     29K             0B         0B    10G
+
+ZRaid/COPYTEST/LIBVIRT_QEMU@pyznap_2023-01-26_21:50:02_frequent ... ZRaid/COPYTEST/LIBVIRT_QEMU@pyznap_2022-11-25_20:34:47_yearly
+ZRaid/PRIMARY/NFSUSER/KUSERS@pyznap_2023-06-15_15:50:01_frequent ... ZRaid/PRIMARY/NFSUSER/KUSERS@pyznap_2022-12-07_15:25:01_yearly
+ZRaid/PRIMARY/NFSUSER/LIBVIRT_IMAGES@pyznap_2023-06-15_15:50:02_frequent ... ZRaid/PRIMARY/NFSUSER/LIBVIRT_IMAGES@pyznap_2022-11-25_20:34:45_yearly
+ZRaid/PRIMARY/NFSUSER/LIBVIRT_QEMU@pyznap_2023-06-15_15:50:02_frequent ... ZRaid/PRIMARY/NFSUSER/LIBVIRT_QEMU@pyznap_2022-11-25_20:34:47_yearly
+zfs-2.1.12-1
+zfs-kmod-2.1.12-1
+
+     Static hostname: kylo.home.goncalo.name
+           Icon name: computer-desktop
+             Chassis: desktop üñ•Ô∏è
+          Machine ID: aaa259174e6448ecb8f2ec4fa5163b48
+             Boot ID: c1311e878073477d977123a2ce95e9f1
+    Operating System: Fedora Linux 38 (Workstation Edition)
+         CPE OS Name: cpe:/o:fedoraproject:fedora:38
+      OS Support End: Tue 2024-05-14
+OS Support Remaining: 10month 4w
+              Kernel: Linux 6.3.7-200.fc38.x86_64
+        Architecture: x86-64
+     Hardware Vendor: System76, Inc.
+      Hardware Model: Wild Dog Pro
+    Firmware Version: F9b Z5
+       Firmware Date: Mon 2018-01-29
+
+--------------------------------------------------------------------
+# prep
+
+* ztool.py prep --pool POOL
+
+Prepares pool by creating the standard set of subvolumes
+POOL/CLONES
+POOL/COPIES
+POOL/PRIMARY/NFSPUB
+POOL/PRIMARY/NFSUSER
+POOL/PRIMARY/NFSNONE
+POOL/MIGRATED
+
+usage: usage: %prog [options] [-h] [--libsrg] [--logfile LOGFILE] [--logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}] [--src_userat SRC_USERAT] [--dst_userat DST_USERAT] [--pool POOL]
+                              {prep,copy,xfer,info,permissions}
+
+positional arguments:
+  {prep,copy,xfer,info,permissions}
+
+options:
+  -h, --help            show this help message and exit
+  --libsrg              Print version of libsrg and exit
+  --logfile LOGFILE     file to log to (default = stdout)
+  --logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}, --level {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}
+  --src_userat SRC_USERAT
+                        user@host for src
+  --dst_userat DST_USERAT
+                        user@host for dst
+  --pool POOL           pool name
+
+---------------------------------------------------------------------
+# xfer
+
+Performs a copy, then dismounts source and mounts destination at original mountpoint
+
+---------------------------------------------------------------------
+# permissions
+
+sets ownership and permissions for files in NFSPUB subvolumes
+
+# python -m libsrg.ztool permissions  --help
+usage: usage: %prog [options] [-h] [--libsrg] [--logfile LOGFILE] [--logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}] [--src_userat SRC_USERAT] [--dst_userat DST_USERAT] [--host HOST]
+                              [--chown]
+                              {prep,copy,xfer,info,permissions}
+
+positional arguments:
+  {prep,copy,xfer,info,permissions}
+
+options:
+  -h, --help            show this help message and exit
+  --libsrg              Print version of libsrg and exit
+  --logfile LOGFILE     file to log to (default = stdout)
+  --logging {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}, --level {CRITICAL,ERROR,WARNING,INFO,DEBUG,NOTSET}
+  --src_userat SRC_USERAT
+                        user@host for src
+  --dst_userat DST_USERAT
+                        user@host for dst
+  --host HOST           host name
+  --chown               enable chown pubshare
+
+"""
+
+
 class Ztool(LoggingAppBase):
 
     def __init__(self):
         super().__init__()
 
         self.first_snap = None
         self.n_snaps = None
@@ -366,16 +547,16 @@
         print()
         for line in self.report:
             print(line)
         print()
 
     def trailer(self):
         self.run_append(["zfs", "version"])
-        self.run_append(["hostnamectl"])
         self.run_append(["date"])
+        self.run_append(["hostnamectl --json=pretty"])
 
     def run_append(self, cmd):
         r0 = Runner(cmd, userat=self.args.dst_userat)
         if r0.success:
             self.report.extend(r0.so_lines)
             self.report.append("")
         else:
@@ -384,15 +565,15 @@
     def process1pool(self, pool: str):
         r0 = Runner(["zpool", "status", pool], userat=self.args.dst_userat)
         if r0.success:
             self.report.extend(r0.so_lines)
             self.report.append("")
         else:
             raise (Exception(r0))
-        r0 = Runner(["zfs", "list", "-o", "space,quota", "-r", pool], userat=self.args.dst_userat)
+        r0 = Runner(["zfs", "list", "-o", "name,avail,used,usedsnap,usedds,quota", "-r", pool], userat=self.args.dst_userat)
         if r0.success:
             self.report.extend(r0.so_lines)
             self.report.append("")
         else:
             raise (Exception(r0))
 
         # r = Runner(["zfs", "list", "-t", "snapshot", "-r", "-H", pool])
@@ -408,15 +589,16 @@
         r = Runner(["zfs", "list", "-t", "snapshot", "-d", "1", "-H", "-o", "name", vol], userat=self.args.dst_userat)
         if r.success:
             if not r.so_lines:
                 return
             first = r.so_lines[0]
             last = r.so_lines[-1]
             self.logger.info(f"{first} -- {last}")
-            self.report.append(f"{last} ... {first}")
+            self.report.append(f"{last}")
+            self.report.append(f"   ... {first}")
 
     @classmethod
     def demo(cls):
         app = Ztool()
 
 
 if __name__ == '__main__':
```

### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

## Comparing `libsrg-3.4.0.dist-info/LICENSE.txt` & `libsrg-3.4.1.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `libsrg-3.4.0.dist-info/METADATA` & `libsrg-3.4.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: libsrg
-Version: 3.4.0
+Version: 3.4.1
 Summary: Base class for logging apps, Nagios, utilities
 Home-page: https://gitlab.com/SRG_gitlab/libsrg
 Author: Steven Goncalo
 Author-email: srg_pypi@ice9mail.com
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `libsrg-3.4.0.dist-info/RECORD` & `libsrg-3.4.1.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -8,18 +8,18 @@
 libsrg/LoggingWatcher.py,sha256=tZ803wbw_qvW8tSRDwAbBRQSCrMzhz-FIJsf_hCNIFo,1376
 libsrg/NagiosBase.py,sha256=5FniCUJ8ywFX8oM2q0gKQX2Wvz6J6yt0HT_WYfPniik,2680
 libsrg/ReZFS.py,sha256=8SInGf72nnju_MRpYqNPtf6VHAqesuZr50_wy7iPE_c,14015
 libsrg/Runner.py,sha256=-L9voGr8ewOQLhtEsZUMUKRHuWpT-UsP_gDCU9PKvwY,4449
 libsrg/Runner2.py,sha256=UDgEAku-g5y9xRrAmr5ZYc4FpZ8rbxSTVX03DV07J8Q,4035
 libsrg/Stage0.py,sha256=6Ni-1rT8BXqEaboss8Sn2IITd_EZmYZCN_Lp9Lz0Cbg,6968
 libsrg/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-libsrg/ztool.py,sha256=Sx33JSJmBA20hljrj-xND1DI05_VWfy7wBrZ3xzKeOQ,17507
+libsrg/ztool.py,sha256=03DOjXoITsf0gXGoa-MACYGjnbCTOJe0WCk0y2qCfcU,25985
 libsrg/TKGUI/GuiBase.py,sha256=MG4D10voRxszQvglABmHG8GHqRNXNo6gWZmY77fpkGU,2214
 libsrg/TKGUI/GuiRequest.py,sha256=ZrUBxrpkAV8ITqbcr7br0-sX9iK69bx1_Fu7COKB5uc,447
 libsrg/TKGUI/GuiRequestQueue.py,sha256=SLoT-PdXgK4JgU-WcESlRwehZIEPBwRgPORn0Tm8Mws,3414
 libsrg/TKGUI/LoggerGUI.py,sha256=A2XBTtlvtNwnxFlw8xTkHkuCITxvgZlQfWjWeaAmejQ,10692
 libsrg/TKGUI/__init__.py,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-libsrg-3.4.0.dist-info/LICENSE.txt,sha256=ACwmltkrXIz5VsEQcrqljq-fat6ZXAMepjXGoe40KtE,1069
-libsrg-3.4.0.dist-info/METADATA,sha256=e-jZT00YyYKhNlPutJdJEORCKE7RJ8wNbtUc-CAoq5c,3357
-libsrg-3.4.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-libsrg-3.4.0.dist-info/top_level.txt,sha256=NYEOHhvqWFavgb_q4ADmjraMpsan8oFEQPXmMMHGvZ0,7
-libsrg-3.4.0.dist-info/RECORD,,
+libsrg-3.4.1.dist-info/LICENSE.txt,sha256=ACwmltkrXIz5VsEQcrqljq-fat6ZXAMepjXGoe40KtE,1069
+libsrg-3.4.1.dist-info/METADATA,sha256=BiRFkfa0drQGjrBM2JU4DoPwE1EChHh852Rn0qTRcco,3357
+libsrg-3.4.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+libsrg-3.4.1.dist-info/top_level.txt,sha256=NYEOHhvqWFavgb_q4ADmjraMpsan8oFEQPXmMMHGvZ0,7
+libsrg-3.4.1.dist-info/RECORD,,
```

